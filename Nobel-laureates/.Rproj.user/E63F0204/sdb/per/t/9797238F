{
    "collab_server" : "",
    "contents" : "\n#clear all lists\nrm(list=ls())\n\nrequire(tidyverse)\nrequire(stringr)\n\n#read in files\ndata = read.csv(\"archive.csv\", header = TRUE )\n\n#only leave relevant columns\ndata = data[, names(data) %in% c(\"Year\", \"Category\", \"Prize.Share\", \"Laureate.Type\", \"Full.Name\", \"Birth.Date\", \"Birth.Country\", \"Sex\", \"Organization.Name\", \"Organization.Country\") ]\n\n#check for NAs\nsapply(data, function(x) sum(is.na(x)))\n\n#create a function which finds the real country name\nrealCountry = function(x){\n  value = \"\\\\(([^()]+)\\\\)\"\n  x = as.character(x)\n  if(grepl(\"\\\\(\",x) == TRUE) {\n    y = gsub(value, \"\\\\1\", ignore.case = TRUE, str_extract_all(x, value)[[1]])\n    return(as.character(y))\n  }\n  else\n  {\n      return(as.character(x))\n    }\n}\n\ndata$Birth.Country <- sapply(data$Birth.Country, realCountry)\n\n\n#separate two lists\ndata.individuals = data [ data$Laureate.Type == \"Individual\" , ]\ndata.organizations = data [ data$Laureate.Type == \"Organization\" , ]\n\n#answer questions related to individuals\n###########################################################\n##### which country has most laureates? which has least? ##\n###########################################################\n\n#use dplyr to arrange countries in descending order  \nlaureates.by.country = data.individuals %>%\n  select(Birth.Country) %>% \n  group_by(Birth.Country) %>% \n  summarise(number = n()) %>% \n  arrange(-number)\n\n###########################################################\n### which country has highest number of women laureates? ##\n###########################################################\n\nlaureates.by.sex = data.individuals %>%\n  select(Sex) %>%\n  group_by(Sex) %>%\n  summarise( number = n() ) %>%\n  arrange (-number)\n\n#by country and by sex\nlaureates.by.sex.by.country = data.individuals %>%\n  select(Sex, Birth.Country) %>%\n  group_by(Sex, Birth.Country) %>%\n  summarise( number = n() ) %>%\n  arrange (-number)\n\n#tidy data\nlaureates.by.sex.by.country = spread(laureates.by.sex.by.country, key = \"Sex\", value = \"number\")\n\n#substitute NAs\nlaureates.by.sex.by.country$Female[is.na(laureates.by.sex.by.country$Female)] <- 0\nlaureates.by.sex.by.country$Male[is.na(laureates.by.sex.by.country$Male)] <- 0\n\n#remove all rows where Female == 0\nlaureates.by.sex.by.country = laureates.by.sex.by.country[ laureates.by.sex.by.country$Female > 0 , ]\n\n\n##########################################################\n#### what's the most common category for each country #####\n##########################################################\n\ncategories.by.country = data.individuals %>%\n  select(Birth.Country, Category) %>% \n  group_by(Birth.Country, Category) %>% \n  summarise(number = n()) %>% \n  filter(number == max(number))\n\n##########################################################\n#### what categories have laureates most commonly shared  ###\n##########################################################\n#in future: display as percentage of total\n\n#find number that follows a forward slash\n\nshared.laureates = data.individuals\nshared.laureates$Prize.Share = substring(shared.laureates$Prize.Share, 3)\n\nshared.laureates$Prize.Share = as.integer(shared.laureates$Prize.Share)\n\n#only display unique category, prize.share, year, country\n#group by country and year, no summarise\n\nshared.laureates = shared.laureates %>%\n  select(Category, max(Prize.Share)) %>%\n  group_by(Category)\n\nshared.laureates = aggregate(shared.laureates$Prize.Share, list(shared.laureates$Category), max)\nnames(shared.laureates) = c(\"Category\", \"Max.share\")\n\n##########################################################\n#### what universities are most common for laureates?  ###\n##########################################################\n\n\nlaureates.by.university = data.individuals\n\nlaureates.by.university = laureates.by.university[ laureates.by.university$Organization.Name != \"\" , names(laureates.by.university) %in% c(\"Category\", \"Organization.Name\") ]\n\nlaureates.by.university = laureates.by.university %>%\n  select(Organization.Name, Category) %>% \n  group_by(Organization.Name, Category) %>% \n  summarise(number = n()) %>% \n  filter(number == max(number))\n\nlaureates.by.university = laureates.by.university %>%\n  select(Category, max(number), Organization.Name) %>%\n  group_by(Category) %>%\n  filter(number == max(number))\n\n\n###########################################################\n#### who are the organizations that receieved a price? ####\n###########################################################\n\nlaureates.organizations = data.organizations %>%\n  select(Category) %>% \n  group_by(Category) %>% \n  summarise(number = n()) %>% \n  arrange(-number)\n\n",
    "created" : 1488038379689.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "555731099",
    "id" : "9797238F",
    "lastKnownWriteTime" : 1488057458,
    "last_content_update" : 1488057621918,
    "path" : "~/GitHub/R-projects/Nobel-laureates/main.R",
    "project_path" : "main.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}